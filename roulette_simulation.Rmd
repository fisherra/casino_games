---
title: "Roulette Simulation"
author: "Fisher Ankney"
date: "4/24/2018"
output: html_document
---

<br> 

### Introduction 

In this post, all about roulette! Now everyone knows the odds of roulette, bet on black, almost 50% chance, bet thirds, almsot a 33% chance, bet a number, no chance! Disecting the probability is easy, we know that the house will always win, sample size increases. Lets make a story out of it. three people at a roulette table with their own styles of playing. Phabian always bets $10 on black. Tammy always bets \$ on the middle third. Latigo always bets \$10 on his favorite number, 23. 

How do they fair against each other after 10 spins? 100 spins? 1000 spins? 10,000 spins?!?
number of wins, amount won, highest high, lowest low, that kind of thing. how many numbers go by before winnning on average for the three players. how long is their longest dry streak? how many wins in a row? 

Going to finish up with creating a simple roulette function, allowing you to place your bet on a number or category, how much you bet on that spin. returns the number, if you win or lose, and your cumulative winnings. 

also, how old are they for sitting through 10,000 spins of the roulette wheel?
- 10,000 spins at 45 spins an hour 9.25 days of continuous play 

roulette(your_number, your_bet, new_game = F)
returns win or loss, cummulative sum of winnings / losings 

i.e.

roulette(6, 100)
-> ** 18 ** 
-> You Lose! 
-> Total Winnings: -$1500

# Load the library
```{r, message=F}
library('tidyverse')
```

Creating the Roulette Data
```{r, cache=T}
roulette <- sample(-1:36, 10000, replace=T)
```

Create the Simulation
```{r}

# Define Bets
black <- c(2, 4, 7, 8, 10, 11, 13, 15, 17, 20, 22, 24, 26, 28, 29, 31, 33, 35)
third_dozen <- c(25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36)
lucky_23 <- 23

# Initialize Variables
# Gambler A
ga_cash <- vector("double", length(roulette))
ga_total_cash <- 0 
ga_wins <- vector("double", length(roulette))
ga_total_wins <- 0 
# Gambler B
gb_cash <- vector("double", length(roulette))
gb_total_cash <- 0 
gb_wins <- vector("double", length(roulette))
gb_total_wins <- 0 
# Gambler C
gc_cash <- vector("double", length(roulette))
gc_total_cash <- 0 
gc_wins <- vector("double", length(roulette))
gc_total_wins <- 0 

for (i in seq_along(roulette)) {
  # All Gamblers Bet
  ga_total_cash = ga_total_cash - 10
  gb_total_cash = gb_total_cash - 10
  gc_total_cash = gc_total_cash - 10
  # If Gambler A Wins
  if (roulette[[i]] %in% black) {
    ga_total_cash = ga_total_cash + 20 
    ga_total_wins = ga_total_wins + 1 
  }
  # If Gambler B Wins
  if (roulette[[i]] %in% third_dozen) {
    gb_total_cash = gb_total_cash + 30 
    gb_total_wins = gb_total_wins + 1
  }
  # If Gambler C Wins
  if (roulette[[i]] == lucky_23) {
    gc_total_cash = gc_total_cash + 360
    gc_total_wins = gc_total_wins + 1
  }
  # End of Round - Save Totals 
  ga_cash[[i]] <- ga_total_cash
  ga_wins[[i]] <- ga_total_wins
  gb_cash[[i]] <- gb_total_cash
  gb_wins[[i]] <- gb_total_wins
  gc_cash[[i]] <- gc_total_cash
  gc_wins[[i]] <- gc_total_wins
}

```
  
Analysis to do - - - 


make sure theres no trend in our roulette data
```{r}
plot(roulette)
```

Combine data into a tibble 

```{r}
ga <- "Gambler A"
gb <- "Gambler B"
gc <- "Gambler C"

results <- tibble(spin_num = 1:10000, ga, ga_cash, ga_wins, gb, gb_cash, gb_wins, gc, gc_cash, gc_wins)
results_100 <- head(results, n=100)
results_1000 <- head(results, n=1000)
```


```{r}
ggplot(results_100) + 
  geom_point(aes(x = spin_num, y = ga_wins, color = ga), alpha = 0.8) + 
  geom_point(aes(x = spin_num, y = gb_wins, color = gb), alpha = 0.8) + 
  geom_point(aes(x = spin_num, y  = gc_wins, color = gc), alpha = 0.8) + 
  theme_minimal() +
  theme(legend.title=element_blank()) + 
  scale_colour_manual(values = c("black", "#E0080B", "#016D29")) + 
    labs(title = "100 Spin Results - Wins", 
       y = "Number of Wins",
       x = "Number of Spins"
       )
```



```{r}
ggplot(results_100) + 
  geom_point(aes(x = spin_num, y = ga_cash, color = ga), alpha = 0.8) + 
  geom_point(aes(x = spin_num, y = gb_cash, color = gb), alpha = 0.8) + 
  geom_point(aes(x = spin_num, y = gc_cash, color = gc), alpha = 0.8) + 
  theme_minimal() +
  theme(legend.title=element_blank()) + 
  scale_colour_manual(values = c("black", "#E0080B", "#016D29")) + 
    labs(title = "100 Spin Results - Earnings", 
       y = "Earnings ($)",
       x = "Number of Spins"
       )
```



```{r}
ggplot(results_1000) + 
  geom_point(aes(x = spin_num, y = ga_cash, color = ga), alpha = 0.8) + 
  geom_point(aes(x = spin_num, y = gb_cash, color = gb), alpha = 0.8) + 
  geom_point(aes(x = spin_num, y  = gc_cash, color = gc), alpha = 0.8) + 
  theme_minimal() +
  theme(legend.title=element_blank()) + 
  scale_colour_manual(values = c("black", "#E0080B", "#016D29")) + 
    labs(title = "1000 Spin Results - Earnings", 
       y = "Earnings ($)",
       x = "Number of Spins"
       )
```


```{r}
ggplot(results) + 
  geom_point(aes(x = spin_num, y = ga_wins, color = ga), alpha = 0.8) + 
  geom_point(aes(x = spin_num, y = gb_wins, color = gb), alpha = 0.8) + 
  geom_point(aes(x = spin_num, y  = gc_wins, color = gc), alpha = 0.8) + 
  theme_minimal() +
  theme(legend.title=element_blank()) + 
  scale_colour_manual(values = c("black", "#E0080B", "#016D29")) + 
    labs(title = "10,000 Spin Results - Wins", 
       y = "Number of Wins",
       x = "Number of Spins"
       )
```



```{r}
ggplot(results) + 
  geom_point(aes(x = spin_num, y = ga_cash, color = ga), alpha = 0.8) + 
  geom_point(aes(x = spin_num, y = gb_cash, color = gb), alpha = 0.8) + 
  geom_point(aes(x = spin_num, y  = gc_cash, color = gc), alpha = 0.8) + 
  theme_minimal() +
  theme(legend.title=element_blank()) + 
  scale_colour_manual(values = c("black", "#E0080B", "#016D29")) + 
    labs(title = "10,000 Spin Results - Earnings", 
       y = "Earnings ($)",
       x = "Number of Spins"
       )
```


trendline for 10,000, average lose per spin for each gambler, max / min, box plot for dry streak each player 

```{r}
ga_total_wins / 10000 * 100
gb_total_wins / 10000 * 100
gc_total_wins / 10000 * 100
```

actual probability of each win - 
half bet = 46.37%
thirds bet = 31.58%
single number bet = 2.63%

Average loss - 
```{r}
ga_total_cash / 10000
gb_total_cash / 10000
gc_total_cash / 10000
```
```{r}
min(ga_cash)
min(gb_cash)
min(gc_cash)

```

```{r}
ga_wins_lead <- lead(ga_wins)
gb_wins_lead <- lead(gb_wins)
gc_wins_lead <- lead(gc_wins) 

ga_wins_binary <- ga_wins_lead - ga_wins
ga_wins_binary[10000] = 0
gb_wins_binary <- gb_wins_lead - gb_wins
gb_wins_binary[10000] = 0 
gc_wins_binary <- gc_wins_lead - gc_wins
gc_wins_binary[10000] = 0

dry_count_a <- 0 
dry_count_save_a  <- vector("double", length(ga_wins_binary))
dry_count_b <- 0
dry_count_save_b  <- vector("double", length(gb_wins_binary))
dry_count_c <- 0
dry_count_save_c  <- vector("double", length(gc_wins_binary))


for (i in seq_along(ga_wins_binary)) {
  if (ga_wins_binary[[i]] == FALSE) {
    dry_count_a = dry_count_a + 1
  }
  if (ga_wins_binary[[i]] == TRUE) {
    dry_count_save_a[[i]] = dry_count_a
    dry_count_a = 0
  } 
}

dry_count_save_a
dry_tibble_a <- tibble("dry_streak" = dry_count_save_a)

ggplot(dry_tibble_a) + 
  geom_bar(aes(dry_streak))
  
for (i in seq_along(gb_wins_binary)) {
  if (gb_wins_binary[[i]] == FALSE) {
    dry_count_b = dry_count_b + 1
  }
  if (gb_wins_binary[[i]] == TRUE) {
    dry_count_save_b[[i]] = dry_count_b
    dry_count_b = 0
  } 
}

dry_count_save_b
dry_tibble_b <- tibble("dry_streak" = dry_count_save_b)

ggplot(dry_tibble_b) + 
  geom_bar(aes(dry_streak))

for (i in seq_along(gc_wins_binary)) {
  if (gc_wins_binary[[i]] == FALSE) {
    dry_count_c = dry_count_c + 1
  }
  if (gc_wins_binary[[i]] == TRUE) {
    dry_count_save_c[[i]] = dry_count_c
    dry_count_c = 0
  } 
}

dry_count_save_c
dry_tibble_c <- tibble("dry_streak" = dry_count_save_c)

ggplot(dry_tibble_c) + 
  geom_bar(aes(dry_streak))

```

create a roulette function

```{r}
mini_roulette <- function(bet, num) {

  print(str_c("You've bet $", bet, " on ", num))
  result = sample(0:12,1)
  print(str_c("The ball has landed on ", result))
  
  if ( num == result ) {
    print(str_c("You've Won $", bet * 36, "!"))
    total_winnings = total_winnings + bet * 36
  } else {
    print ("You Lose!")
    total_winnings = total_winnings - bet
  }
  print(str_c("Your total winnings are ", total_winnings, " dollars"))
}

mini_roulette(100, 0)
mini_roulette(100, 1)
mini_roulette(100, 2)
```
